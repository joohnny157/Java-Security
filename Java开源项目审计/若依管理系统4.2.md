
存在

1、shiro反序列化

2、Fastjson

3、Thymeleaf模板注入

4、SQL注入

5、任意文件读取/下载

6、定时任务


shiro反序列化：

检查pom文件
发现使用了shiro1.4.2

<img width="1163" height="762" alt="Image" src="https://github.com/user-attachments/assets/0e28a5db-f903-4fd0-ab07-e1b0493a5e42" />

该版本存在shiro反序列化漏洞

<img width="761" height="628" alt="Image" src="https://github.com/user-attachments/assets/1cfe3099-5759-421c-b15d-33be8d41e933" />

<img width="761" height="628" alt="Image" src="https://github.com/user-attachments/assets/0bef716d-0b6a-4911-8257-75fb937a49cd" />

检查pom文件：

<img width="1280" height="770" alt="Image" src="https://github.com/user-attachments/assets/7af718ec-62c5-4145-b1ed-863edd1b8069" />

发现使用了fastjson1.2.60版本
Fastjson <= 1.2.68 都存在这个漏洞

关注关键函数 parse()和 parseObject()
存在四个调用处

<img width="840" height="432" alt="Image" src="https://github.com/user-attachments/assets/cab85d80-898e-4370-9a6d-ce2811f10255" />
而这四个调用处都传入了options

复现不了，我是废物！

SQL注入漏洞：

首先全局搜索${
查看拼接的SQL

<img width="840" height="432" alt="Image" src="https://github.com/user-attachments/assets/c967a814-0954-4341-8f57-43f853cda52f" />

SysDeptMapper,SysUserMapper,SysRoleMapper可能存在SQL注入漏洞
搜索来到SysDeptMapper下

<img width="1022" height="762" alt="Image" src="https://github.com/user-attachments/assets/48d01378-b529-4405-adc4-0497a123d95d" />

跟进 根据注释发现是查询部门管理数据，部门信息的功能

<img width="1022" height="762" alt="Image" src="https://github.com/user-attachments/assets/8bfb77d1-d09e-4ab5-9b18-ac55716a5be2" />

<img width="1022" height="762" alt="Image" src="https://github.com/user-attachments/assets/89cba7c5-4b82-459d-a8bb-7c2183e5a829" />

再次跟进来到Controller层

<img width="1022" height="762" alt="Image" src="https://github.com/user-attachments/assets/40147118-5b34-45c2-ba20-33c958f81c9d" />

接口位于/system/dept/list

<img width="1280" height="754" alt="Image" src="https://github.com/user-attachments/assets/8424e729-b092-4ef8-87c1-867f36feccb5" />

直接来到部门管理找查询搜索功能

<img width="879" height="710" alt="Image" src="https://github.com/user-attachments/assets/8b1cbf20-9ec4-457f-8fc8-6564e00934b4" />

但是并没有找到mapper层的params.dataScope

直接在后面加一个params[dataScope]=

<img width="879" height="710" alt="Image" src="https://github.com/user-attachments/assets/9d0cf3ab-a3f1-4c3e-906b-4a11939d5f0e" />

输入引号报错
上SQLmap

<img width="876" height="468" alt="Image" src="https://github.com/user-attachments/assets/6b19f3d6-e5de-49cb-934c-62ce041c0300" />

存在SQL注入

其他Mapper层的params.dataScope也同样存在SQL注入

任意文件读取/下载漏洞：

位于 src/main/java/com/ruoyi/web/controller/common/CommonController.java












